#!/bin/bash


theme=$(ls "/home/philipp/.config/mondo/themes" | grep "^[^._]" | dmenu -p "theme: ")
mondo -a $theme


##### reload st-windows
externalpipe_buffer.sh st_reloadsignal

##### tmux-zsh-base16-source
## just if it doesnt wait until it escapes (C-[)
#for i in {1..10}; do tmux list-panes -as -F "#{session_name}:#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE 'C-['; done
##tmux list-panes -as -F "#{session_name}:#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE 'C-['
#
#tmux list-panes -as -F "#{session_name}:#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE C-z
#tmux list-panes -as -F "#{session_name}:#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE C-c
##tmux list-panes -as -F "#{session_name}:#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE " source ~/.bashrc; fg &> /dev/null; echo -n" C-m
#tmux list-panes -as -F "#{session_name}:#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE "source ~/.zshrc" C-m
#tmux list-panes -as -F "#{session_name}:#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE "fg > /dev/null 2>&1" C-m
for i in {1..10}; do tmux list-panes -s -F "#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE 'C-['; done
tmux list-panes -s -F "#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE C-z
tmux list-panes -s -F "#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE C-c
sleep 0.2
tmux list-panes -s -F "#{window_index}.#{pane_index}" | xargs -I PANE tmux send-keys -t PANE " source ~/.zshrc && fg > /dev/null 2>&1" C-m
neovim-reload.py

##### change gtk-theme
name=$(mondo get shell)
sed -i "s/gtk-theme-name=\".[^]]*\"/gtk-theme-name=\"$name\"/g" /home/philipp/.gtkrc-2.0
sed -i "s/gtk-icon-theme-name=\".[^]]*\"/gtk-icon-theme-name=\"$name\"/g" /home/philipp/.gtkrc-2.0
sed -i "s/gtk-theme-name=.*/gtk-theme-name=$name/g" /home/philipp/.config/gtk-3.0/settings.ini
sed -i "s/gtk-icon-theme-name=.*/gtk-icon-theme-name=$name/g" /home/philipp/.config/gtk-3.0/settings.ini

##### change background-color
color=$(mondo get base02)
sed -i "s/hsetroot.*/hsetroot -solid \"#$color\" \&/g" /home/philipp/bin/dwm-starter
hsetroot -solid "#$color"

###### dwm-xrdb hack.... not refreshing in mondo... + rescale windows to fix glitches
xsetroot -name "fsignal:1"
xsetroot -name "fsignal:2"

##### restart nm-applet icon
killall nm-applet; nm-applet &
killall polkit-gnome-authentication-agent-1; /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &
